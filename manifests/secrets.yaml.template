---
# Secrets Template for DevOps RCA Agent
#
# IMPORTANT: This is a TEMPLATE file. Do not edit directly or add real credentials here.
#
# Quick Setup:
# 1. Copy this template to create your secrets file:
#    cp manifests/secrets.yaml.template manifests/secrets.yaml
#
# 2. Edit manifests/secrets.yaml with your actual credentials
#
# 3. Apply the secrets:
#    kubectl apply -f manifests/secrets.yaml
#
# 4. Verify secrets were created:
#    kubectl get secrets -n analysis-agent
#
# Note: manifests/secrets.yaml is in .gitignore and will NOT be tracked in git

---
# Gmail SMTP Credentials
#
# To get Gmail app password:
# 1. Enable 2FA on your Google account: https://myaccount.google.com/security
# 2. Generate app password: https://myaccount.google.com/apppasswords
# 3. Use the 16-character app password below (not your regular password)
apiVersion: v1
kind: Secret
metadata:
  name: gmail-credentials
  namespace: analysis-agent
  labels:
    app: devops-rca
    component: notifier
type: Opaque
stringData:
  # Gmail address (e.g., your-email@gmail.com)
  username: "your-email@gmail.com"

  # Gmail app password (16 characters, spaces will be removed)
  # Generate at: https://myaccount.google.com/apppasswords
  password: "your-app-password-here"

  # From address for emails (usually same as username)
  from-address: "DevOps RCA Agent <your-email@gmail.com>"

---
# Email Recipients by Severity
#
# Configure different recipients for different severity levels.
# Use comma-separated email addresses for multiple recipients.
apiVersion: v1
kind: Secret
metadata:
  name: email-recipients
  namespace: analysis-agent
  labels:
    app: devops-rca
    component: notifier
type: Opaque
stringData:
  # Critical alerts - highest priority (e.g., production outages)
  # Sent to: On-call team, SRE team lead
  recipients-critical: "oncall@example.com,sre-lead@example.com"

  # Warning alerts - medium priority (e.g., degraded performance)
  # Sent to: DevOps team
  recipients-warning: "devops@example.com"

  # Info alerts - low priority (e.g., informational notices)
  # Sent to: DevOps alerts mailing list
  recipients-info: "devops-alerts@example.com"

---
# GitHub API Credentials (Optional)
#
# Only needed if you want to correlate incidents with GitHub commits/workflows.
# GitHub personal access token with repo:read scope.
#
# To create token:
# 1. Go to: https://github.com/settings/tokens
# 2. Click "Generate new token (classic)"
# 3. Select scopes: repo (or repo:read for read-only)
# 4. Copy the token and paste below
apiVersion: v1
kind: Secret
metadata:
  name: github-credentials
  namespace: analysis-agent
  labels:
    app: devops-rca
    component: agent
type: Opaque
stringData:
  # GitHub personal access token
  # Leave empty if not using GitHub integration
  token: ""

---
# Additional Instructions:
#
# Testing SMTP connection:
#   kubectl port-forward svc/notifier-service 8080:8080 -n analysis-agent
#   curl -X POST http://localhost:8080/api/v1/test-email \
#     -H "Content-Type: application/json" \
#     -d '{"recipients": ["your-test-email@example.com"]}'
#
# Verify secrets:
#   kubectl describe secret gmail-credentials -n analysis-agent
#   kubectl describe secret email-recipients -n analysis-agent
#
# Security Best Practices:
# - Never commit secrets to version control (secrets.yaml is in .gitignore)
# - Use different credentials for dev/staging/production
# - Rotate credentials regularly
# - Limit Gmail app password scope (only SMTP)
# - Use Kubernetes RBAC to restrict secret access
# - Consider using external secret management (e.g., Sealed Secrets, External Secrets Operator)
